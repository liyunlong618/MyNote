# GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性
- <font color=#DC2D1E>**处理关键点：**</font>
    - <font color=#DC2D1E>**1.自定义属性计算方式需要创建类GameplayModMagnitudecalculation**</font>
        - <font color=#DC2D1E>**//步骤一：需要依赖的属性 要创建FGameplayEffectAttributecaptureDefinition类变量 构造中，给变量配置参数**</font>
        - <font color=#DC2D1E>**//步骤二：重写虚函数CalculateBaseMagnitude并调用核心处理APIGetCapturedAttributeMagnitude为变量赋值，然后通过FGameplayEffectSpec拿到角色数据，计算并返回**</font>
        - <font color=#DC2D1E>**//步骤三：GE中配置自定义计算方式**</font>
- 下一步任务
    -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-783593-966830.png)
    -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-61766-180318.png)
- 创建 GameplayModMagnitudeCalculation 类C++文件（- 游戏修正幅度计算）又叫MMC
    -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-918871-880172.png)
    -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-779229-219152.png)
    -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-886762-90298.png)
- UMMC_MaxHealth 中创建构造，重写 `CalculateBaseMagnitude` 虚函数，并创建一个 `FGameplayEffectAttributeCaptureDefinition` 类型的变量（这个类型是一个集合信息的结构体）
    -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-415115-796974.png)
    -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-535795-916183.png)
- 修改 **GE_AuraSecondaryAttributes** 次要属性中的MaxHP的计算方式
    -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-329204-263916.png)
    -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-845159-788059.png)
- 这里处理之前的遗漏
    - 1.Source为空，因为 AAuraCharacterBase 中初始化属性(应用GE)时并没有指定Source
        -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-273965-855642.png)
    - 2.PS中Level没有给默认为1所以初始等级为0
        -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-21499-80346.png)
- 测试结果
    - 所以MaxHP=80+9*1*15=215 ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-951979-960659.png)
    -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-753239-698218.png)
- 小测试：使用自定义属性计算方式法力最大值 ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-264761-928466.png)
    - 自己尝试一下
        -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-350456-377917.png)
        -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-816069-587295.png)
        -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-221407-939573.png)
- 测试结果
    - 所以MaxMP=90+17*1*25=515 ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-513529-21156.png)
    - 当然我这个数值设定不一定合理，这个随意 ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-371823-625409.png)
- 使用自定义后的值初始化HP/MP属性
    - 不用在 UAuraAttributeSet 构造中初始化HP/MP了
        -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-725722-545360.png)
- 小测试：初始化HP/MP使用最大值， 提示：使用GE ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-200484-902910.png)
    - 自己尝试一下
        -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-439807-232906.png)
        -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-246098-838931.png)
        -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-679826-404457.png)
        -  ![图片](./GAS 3.8 MMC——Modifier Magnitude calculation(自定义属性计算方式);以及如何使用自定义后的值初始化HP/MP属性-幕布图片-99329-535508.png)