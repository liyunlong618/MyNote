# GAS 3.3 拾取道具的小UI；HP和MP的滞后效果
- <font color=#DC2D1E>**处理关键点：**</font>
    - <font color=#DC2D1E>**1.重写后处理函数PostGameplayEffectExecute，使用clamp限制**</font>
- 创建小UI 并 添加到屏幕
    -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-467859-735333.png)
    -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-173053-807791.png)
    -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-182466-385222.png)
    -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-798384-646745.png)
    -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-333787-583661.png)
    -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-551622-875563.png)
    -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-882976-176115.png)
    - 加了一个 image 的IsVaild判断 ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-693641-102197.png)
- 创建小UI动画和设置销毁
    -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-563304-829977.png)
    - gif ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-239286-829790.gif)
    -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-638566-686874.png)
        -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-126400-127802.png)
    -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-895122-300327.png)
- 小测试：修改回调为Lambda表达式
    - 这些
        -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-176239-906839.png)
    - 自己做一下
        - 头文件
            -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-542221-807520.png)
        - 源文件
            -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-320357-593845.png)
            -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-973140-103157.png)
- UOverlayWidgetController 中新建一个总的属性多播，整理一下原来的多播种类
    -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-880172-305839.png)
    -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-493672-129556.png)
- 此时蓝图中出现报错
    - 基类中，修改变量类型 ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-219391-468334.png)
        -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-662203-147165.png)
    - 子类HP中 ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-675127-149809.png)
        -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-586928-223458.png)
    - 子类MP中 ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-745992-118521.png)
        -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-428986-565571.png)
- 小测试：尝试制作 HP和MP的滞后效果 ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-903809-875734.png)
    - 自己尝试一下
        -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-68358-467300.png)
        -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-231137-171233.png)
        -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-653462-222332.png)
        -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-807524-140717.png)
        -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-330977-870845.png)
        -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-894388-962006.png)
            -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-357525-104251.png)
            -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-747510-935390.png)
        -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-561606-796078.png)
        -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-196103-436756.png)
    - tick打包成一个函数
        -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-257056-309009.png)
        -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-60445-685590.png)
- 有个小Bug，开始的时候，HP/MP也会有延迟的效果
    -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-371565-756472.png)
- 此时效果gif ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-769563-447816.gif)
- **此时有一个bug** ：当player拾取加血道具，使得血量远超过最大值时，正常应该是限制在了maxHP,也就是最大值，这时候，进入火堆，一段时间内不会掉血，此时断点查看属性
    - 也就是说加血会超出100，但只显示100
    - 发现只是显示时被夹在了0到MaxHP，实际上值还是在增加
        -  ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-751846-613810.png)
    - 说明PreAttributeChange函数中修改的是只读参数，实际值并未发生改变。所以必须在PostGameplayEffectExecute函数(这个是处理后的函数)中进行Clamp和set属性
        - 在PostGameplayEffectExecute函数中进行Clamp和set属性 ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-367399-347987.png)
- 此时效果gif ![图片](./GAS 3.3 拾取道具的小UI；HP和MP的滞后效果-幕布图片-743511-941191.gif)